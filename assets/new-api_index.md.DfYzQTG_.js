import{_ as o,I as h,o as n,c as r,aj as d,J as a,w as s,a as i}from"./chunks/framework.DpVzuYkC.js";const I=JSON.parse('{"title":"New-API","description":"","frontmatter":{},"headers":[],"relativePath":"new-api/index.md","filePath":"new-api/README.md"}'),c={name:"new-api/index.md"};function l(E,t,_,p,k,T){const e=h("Callout");return n(),r("div",null,[t[3]||(t[3]=d('<h1 id="new-api" tabindex="-1">New-API <a class="header-anchor" href="#new-api" aria-label="Permalink to “New-API”">​</a></h1><p><a href="https://www.newapi.ai/" target="_blank" rel="noreferrer">Office Web</a> - <a href="https://github.com/QuantumNous/new-api" target="_blank" rel="noreferrer">Source</a> - <a href="https://hub.docker.com/r/calciumion/new-api" target="_blank" rel="noreferrer">Docker Image</a> - <a href="https://www.newapi.ai/zh/docs/installation/deployment-methods/docker-compose-installation" target="_blank" rel="noreferrer">Document</a></p><hr><blockquote><p><a href="https://www.newapi.ai/" target="_blank" rel="noreferrer">New-API</a> 是新一代 AI 基座平台，为您的 AI 应用提供统一的基础设施。承载所有 AI 应用，管理您的数字资产，连接未来的统一接口平台。</p></blockquote><h2 id="核心特性" tabindex="-1">核心特性 <a class="header-anchor" href="#核心特性" aria-label="Permalink to “核心特性”">​</a></h2><ul><li>统一接口：一个 API 端点接入所有 AI 服务，兼容 OpenAI 标准格式</li><li>智能路由：多渠道负载均衡、故障自动切换、加权随机分发</li><li>精细计费：支持按次数/按量计费、预付费充值、多倍率配置</li><li>安全管控：令牌权限管理、模型访问控制、API 调用审计</li><li>数据洞察：实时数据看板、用量统计、成本分析</li><li>多租户架构：完美适配个人开发者、团队协作与企业级部署</li></ul><hr><h2 id="基本配置" tabindex="-1">基本配置 <a class="header-anchor" href="#基本配置" aria-label="Permalink to “基本配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>PORT</code></td><td>服务监听端口</td><td><code>3000</code></td><td><code>PORT=8080</code></td></tr><tr><td><code>TZ</code></td><td>时区设置</td><td>-</td><td><code>TZ=America/New_York</code></td></tr><tr><td><code>VERSION</code></td><td>覆盖运行版本号</td><td>-</td><td><code>VERSION=1.2.3</code></td></tr></tbody></table><h2 id="数据库配置" tabindex="-1">数据库配置 <a class="header-anchor" href="#数据库配置" aria-label="Permalink to “数据库配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>SQL_DSN</code></td><td>数据库连接字符串</td><td>SQLite (data/one-api.db)</td><td>MySQL: <code>SQL_DSN=root:123456@tcp(localhost:3306)/new-api</code> | PostgreSQL: <code>SQL_DSN=postgresql://root:123456@postgres:5432/new-api</code></td></tr><tr><td><code>SQL_MAX_IDLE_CONNS</code></td><td>空闲连接池最大连接数</td><td><code>100</code></td><td><code>SQL_MAX_IDLE_CONNS=50</code></td></tr><tr><td><code>SQL_MAX_OPEN_CONNS</code></td><td>连接池最大打开连接数</td><td><code>1000</code></td><td><code>SQL_MAX_OPEN_CONNS=500</code></td></tr><tr><td><code>SQL_MAX_LIFETIME</code></td><td>连接最大生命周期(分钟)</td><td><code>60</code></td><td><code>SQL_MAX_LIFETIME=120</code></td></tr><tr><td><code>LOG_SQL_DSN</code></td><td>日志表独立数据库连接字符串</td><td>-</td><td><code>LOG_SQL_DSN=root:123456@tcp(localhost:3306)/oneapi_logs</code></td></tr><tr><td><code>SQLITE_PATH</code></td><td>SQLite数据库路径</td><td><code>/path/to/sqlite.db</code></td><td><code>SQLITE_PATH=/var/lib/new-api/new-api.db</code></td></tr></tbody></table><h2 id="缓存配置" tabindex="-1">缓存配置 <a class="header-anchor" href="#缓存配置" aria-label="Permalink to “缓存配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>REDIS_CONN_STRING</code></td><td>Redis连接字符串</td><td>-</td><td><code>REDIS_CONN_STRING=redis://default:redispw@localhost:6379</code></td></tr><tr><td><code>MEMORY_CACHE_ENABLED</code></td><td>是否启用内存缓存</td><td><code>false</code></td><td><code>MEMORY_CACHE_ENABLED=true</code></td></tr><tr><td><code>REDIS_POOL_SIZE</code></td><td>Redis连接池大小</td><td><code>10</code></td><td><code>REDIS_POOL_SIZE=20</code></td></tr><tr><td><code>BATCH_UPDATE_ENABLED</code></td><td>启用数据库批量更新聚合</td><td><code>false</code></td><td><code>BATCH_UPDATE_ENABLED=true</code></td></tr><tr><td><code>BATCH_UPDATE_INTERVAL</code></td><td>批量更新聚合时间间隔(秒)</td><td><code>5</code></td><td><code>BATCH_UPDATE_INTERVAL=10</code></td></tr></tbody></table><h2 id="多节点与安全配置" tabindex="-1">多节点与安全配置 <a class="header-anchor" href="#多节点与安全配置" aria-label="Permalink to “多节点与安全配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>SESSION_SECRET</code></td><td>会话密钥(多机部署必须)</td><td>-</td><td><code>SESSION_SECRET=random_string</code></td></tr><tr><td><code>CRYPTO_SECRET</code></td><td>加密密钥(加密数据库内容)</td><td>-</td><td><code>CRYPTO_SECRET=your_crypto_secret</code></td></tr><tr><td><code>FRONTEND_BASE_URL</code></td><td>前端基础URL</td><td>-</td><td><code>FRONTEND_BASE_URL=https://your-domain.com</code></td></tr><tr><td><code>SYNC_FREQUENCY</code></td><td>缓存与数据库同步频率(秒)</td><td><code>60</code></td><td><code>SYNC_FREQUENCY=60</code></td></tr><tr><td><code>NODE_TYPE</code></td><td>节点类型</td><td><code>master</code></td><td><code>NODE_TYPE=slave</code></td></tr></tbody></table>',15)),a(e,{type:"info",title:"集群部署"},{default:s(()=>[...t[0]||(t[0]=[i(" 关于如何使用这些环境变量构建完整的集群部署，请参考[集群部署指南](/zh/docs/installation/deployment-methods/cluster-deployment)。 ",-1)])]),_:1}),t[4]||(t[4]=d('<h2 id="用户及令牌配置" tabindex="-1">用户及令牌配置 <a class="header-anchor" href="#用户及令牌配置" aria-label="Permalink to “用户及令牌配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>GENERATE_DEFAULT_TOKEN</code></td><td>为新注册用户生成初始令牌</td><td><code>false</code></td><td><code>GENERATE_DEFAULT_TOKEN=true</code></td></tr><tr><td><code>NOTIFICATION_LIMIT_DURATION_MINUTE</code></td><td>通知限制的持续时间(分钟)</td><td><code>10</code></td><td><code>NOTIFICATION_LIMIT_DURATION_MINUTE=15</code></td></tr><tr><td><code>NOTIFY_LIMIT_COUNT</code></td><td>指定持续时间内的最大通知数量</td><td><code>2</code></td><td><code>NOTIFY_LIMIT_COUNT=3</code></td></tr></tbody></table><h2 id="请求限制配置" tabindex="-1">请求限制配置 <a class="header-anchor" href="#请求限制配置" aria-label="Permalink to “请求限制配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>GLOBAL_API_RATE_LIMIT</code></td><td>全局API速率限制(单IP三分钟)</td><td><code>180</code></td><td><code>GLOBAL_API_RATE_LIMIT=100</code></td></tr><tr><td><code>GLOBAL_WEB_RATE_LIMIT</code></td><td>全局Web速率限制(单IP三分钟)</td><td><code>60</code></td><td><code>GLOBAL_WEB_RATE_LIMIT=30</code></td></tr><tr><td><code>RELAY_TIMEOUT</code></td><td>中继请求超时时间(秒)</td><td><code>0</code></td><td><code>RELAY_TIMEOUT=60</code></td></tr><tr><td><code>STREAMING_TIMEOUT</code></td><td>流式一次回复的超时时间(秒)</td><td><code>300</code></td><td><code>STREAMING_TIMEOUT=120</code></td></tr><tr><td><code>MAX_FILE_DOWNLOAD_MB</code></td><td>最大文件下载大小(MB)</td><td><code>20</code></td><td><code>MAX_FILE_DOWNLOAD_MB=50</code></td></tr><tr><td><code>MAX_REQUEST_BODY_MB</code></td><td>最大请求体大小(MB，解压后计；防止超大请求/zip bomb导致内存暴涨)</td><td><code>64</code></td><td><code>MAX_REQUEST_BODY_MB=100</code></td></tr><tr><td><code>GLOBAL_API_RATE_LIMIT_ENABLE</code></td><td>全局API速率限制开关</td><td><code>true</code></td><td><code>GLOBAL_API_RATE_LIMIT_ENABLE=false</code></td></tr><tr><td><code>GLOBAL_API_RATE_LIMIT_DURATION</code></td><td>全局API速率限制窗口(秒)</td><td><code>180</code></td><td><code>GLOBAL_API_RATE_LIMIT_DURATION=120</code></td></tr><tr><td><code>GLOBAL_WEB_RATE_LIMIT_ENABLE</code></td><td>全局Web速率限制开关</td><td><code>true</code></td><td><code>GLOBAL_WEB_RATE_LIMIT_ENABLE=false</code></td></tr><tr><td><code>GLOBAL_WEB_RATE_LIMIT_DURATION</code></td><td>全局Web速率限制窗口(秒)</td><td><code>180</code></td><td><code>GLOBAL_WEB_RATE_LIMIT_DURATION=120</code></td></tr><tr><td><code>CRITICAL_RATE_LIMIT_ENABLE</code></td><td>关键操作速率限制开关</td><td><code>true</code></td><td><code>CRITICAL_RATE_LIMIT_ENABLE=false</code></td></tr><tr><td><code>CRITICAL_RATE_LIMIT</code></td><td>关键操作速率限制次数</td><td><code>20</code></td><td><code>CRITICAL_RATE_LIMIT=10</code></td></tr><tr><td><code>CRITICAL_RATE_LIMIT_DURATION</code></td><td>关键操作速率限制窗口(秒)</td><td><code>1200</code></td><td><code>CRITICAL_RATE_LIMIT_DURATION=600</code></td></tr></tbody></table>',4)),a(e,{type:"warn",title:"RELAY_TIMEOUT 设置警告"},{default:s(()=>[...t[1]||(t[1]=[i(" 设置 `RELAY_TIMEOUT` 环境变量时请谨慎，如果设置过短可能导致以下问题： ",-1)])]),_:1}),t[5]||(t[5]=d(`<ul><li><p>上游API已经完成请求并计费，但本地因超时而未完成计费</p></li><li><p>造成计费不同步，可能导致系统亏损</p></li><li><p>建议不设置，除非您知道自己在做什么</p></li></ul><h2 id="渠道管理配置" tabindex="-1">渠道管理配置 <a class="header-anchor" href="#渠道管理配置" aria-label="Permalink to “渠道管理配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>CHANNEL_UPDATE_FREQUENCY</code></td><td>定期更新渠道余额(分钟)</td><td>-</td><td><code>CHANNEL_UPDATE_FREQUENCY=1440</code></td></tr><tr><td><code>CHANNEL_TEST_FREQUENCY</code></td><td>定期检查渠道(分钟)</td><td>-</td><td><code>CHANNEL_TEST_FREQUENCY=1440</code></td></tr><tr><td><code>POLLING_INTERVAL</code></td><td>批量更新渠道时请求间隔(秒)</td><td><code>0</code></td><td><code>POLLING_INTERVAL=5</code></td></tr><tr><td><code>ENABLE_METRIC</code></td><td>是否根据请求成功率禁用渠道</td><td><code>false</code></td><td><code>ENABLE_METRIC=true</code></td></tr><tr><td><code>METRIC_QUEUE_SIZE</code></td><td>请求成功率统计队列大小</td><td><code>10</code></td><td><code>METRIC_QUEUE_SIZE=20</code></td></tr><tr><td><code>METRIC_SUCCESS_RATE_THRESHOLD</code></td><td>请求成功率阈值</td><td><code>0.8</code></td><td><code>METRIC_SUCCESS_RATE_THRESHOLD=0.7</code></td></tr><tr><td><code>TEST_PROMPT</code></td><td>测试模型时的用户prompt</td><td><code>Print your model name exactly...</code></td><td><code>TEST_PROMPT=Hello</code></td></tr></tbody></table><h2 id="模型和请求处理配置" tabindex="-1">模型和请求处理配置 <a class="header-anchor" href="#模型和请求处理配置" aria-label="Permalink to “模型和请求处理配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>FORCE_STREAM_OPTION</code></td><td>覆盖客户端stream_options参数</td><td><code>true</code></td><td><code>FORCE_STREAM_OPTION=false</code></td></tr><tr><td><code>GET_MEDIA_TOKEN</code></td><td>是否统计图片token</td><td><code>true</code></td><td><code>GET_MEDIA_TOKEN=false</code></td></tr><tr><td><code>GET_MEDIA_TOKEN_NOT_STREAM</code></td><td>非流模式下是否统计图片token</td><td><code>false</code></td><td><code>GET_MEDIA_TOKEN_NOT_STREAM=false</code></td></tr><tr><td><code>UPDATE_TASK</code></td><td>是否更新异步任务(MJ、Suno)</td><td><code>true</code></td><td><code>UPDATE_TASK=false</code></td></tr><tr><td><code>CountToken</code></td><td>是否统计文本token</td><td><code>true</code></td><td><code>CountToken=false</code></td></tr><tr><td><code>TASK_PRICE_PATCH</code></td><td>任务价格补丁，设置的模型仅按次计费，模型名用英文逗号<code>,</code>隔开</td><td><code>&quot;&quot;</code></td><td><code>TASK_PRICE_PATCH=sora-2,sora-2-pro</code></td></tr></tbody></table><h2 id="特定模型配置" tabindex="-1">特定模型配置 <a class="header-anchor" href="#特定模型配置" aria-label="Permalink to “特定模型配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>AZURE_DEFAULT_API_VERSION</code></td><td>Azure渠道默认API版本</td><td><code>2025-04-01-preview</code></td><td><code>AZURE_DEFAULT_API_VERSION=2023-05-15</code></td></tr><tr><td><code>COHERE_SAFETY_SETTING</code></td><td>Cohere模型安全设置</td><td><code>NONE</code></td><td><code>COHERE_SAFETY_SETTING=CONTEXTUAL</code></td></tr><tr><td><code>GEMINI_VISION_MAX_IMAGE_NUM</code></td><td>Gemini模型最大图片数量</td><td><code>16</code></td><td><code>GEMINI_VISION_MAX_IMAGE_NUM=8</code></td></tr><tr><td><code>DIFY_DEBUG</code></td><td>Dify渠道输出工作流和节点信息</td><td><code>true</code></td><td><code>DIFY_DEBUG=false</code></td></tr></tbody></table><h2 id="其他配置" tabindex="-1">其他配置 <a class="header-anchor" href="#其他配置" aria-label="Permalink to “其他配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>ERROR_LOG_ENABLED</code></td><td>是否记录并在前端显示错误日志</td><td>false</td><td><code>ERROR_LOG_ENABLED=true</code></td></tr></tbody></table><h2 id="分析统计" tabindex="-1">分析统计 <a class="header-anchor" href="#分析统计" aria-label="Permalink to “分析统计”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>UMAMI_WEBSITE_ID</code></td><td>Umami站点ID</td><td>-</td><td><code>UMAMI_WEBSITE_ID=xxxx-xxxx</code></td></tr><tr><td><code>UMAMI_SCRIPT_URL</code></td><td>Umami脚本地址</td><td><code>https://analytics.umami.is/script.js</code></td><td><code>UMAMI_SCRIPT_URL=https://umami.example.com/script.js</code></td></tr><tr><td><code>GOOGLE_ANALYTICS_ID</code></td><td>Google Analytics站点ID</td><td>-</td><td><code>GOOGLE_ANALYTICS_ID=G-XXXXXXX</code></td></tr></tbody></table><h2 id="元数据同步" tabindex="-1">元数据同步 <a class="header-anchor" href="#元数据同步" aria-label="Permalink to “元数据同步”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>SYNC_UPSTREAM_BASE</code></td><td>模型/厂商元数据上游地址</td><td><code>https://basellm.github.io/llm-metadata</code></td><td><code>SYNC_UPSTREAM_BASE=https://mirror.example.com/llm-metadata</code></td></tr><tr><td><code>SYNC_HTTP_TIMEOUT_SECONDS</code></td><td>同步HTTP超时(秒)</td><td><code>10</code></td><td><code>SYNC_HTTP_TIMEOUT_SECONDS=15</code></td></tr><tr><td><code>SYNC_HTTP_RETRY</code></td><td>同步重试次数</td><td><code>3</code></td><td><code>SYNC_HTTP_RETRY=5</code></td></tr><tr><td><code>SYNC_HTTP_MAX_MB</code></td><td>响应体最大大小(MB)</td><td><code>10</code></td><td><code>SYNC_HTTP_MAX_MB=20</code></td></tr></tbody></table><h2 id="前端配置" tabindex="-1">前端配置 <a class="header-anchor" href="#前端配置" aria-label="Permalink to “前端配置”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>VITE_REACT_APP_SERVER_URL</code></td><td>前端请求后端的基础地址</td><td>-</td><td><code>VITE_REACT_APP_SERVER_URL=https://api.example.com</code></td></tr></tbody></table><h2 id="已废弃的环境变量" tabindex="-1">已废弃的环境变量 <a class="header-anchor" href="#已废弃的环境变量" aria-label="Permalink to “已废弃的环境变量”">​</a></h2><p>以下环境变量已被废弃，请使用系统设置界面中的相应选项：</p><table tabindex="0"><thead><tr><th>环境变量</th><th>替代方式</th></tr></thead><tbody><tr><td><code>GEMINI_MODEL_MAP</code></td><td>请在系统设置-模型相关设置中设置</td></tr><tr><td><code>GEMINI_SAFETY_SETTING</code></td><td>请在系统设置-模型相关设置中设置</td></tr></tbody></table><h2 id="多机部署示例" tabindex="-1">多机部署示例 <a class="header-anchor" href="#多机部署示例" aria-label="Permalink to “多机部署示例”">​</a></h2><p>在多机部署场景中，必须设置以下环境变量：</p><h3 id="主节点配置" tabindex="-1">主节点配置 <a class="header-anchor" href="#主节点配置" aria-label="Permalink to “主节点配置”">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 数据库配置 - 使用远程数据库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SQL_DSN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">root:password@tcp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">db-server:3306</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/oneapi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安全配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SESSION_SECRET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_unique_session_secret</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CRYPTO_SECRET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_unique_crypto_secret</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Redis缓存配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">REDIS_CONN_STRING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">redis://default:password@redis-server:6379</span></span></code></pre></div><h3 id="从节点配置" tabindex="-1">从节点配置 <a class="header-anchor" href="#从节点配置" aria-label="Permalink to “从节点配置”">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 数据库配置 - 使用相同的远程数据库</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SQL_DSN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">root:password@tcp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">db-server:3306</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/oneapi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安全配置 - 与主节点使用相同的密钥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SESSION_SECRET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_unique_session_secret</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CRYPTO_SECRET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your_unique_crypto_secret</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Redis缓存配置 - 与主节点使用相同的Redis</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">REDIS_CONN_STRING</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">redis://default:password@redis-server:6379</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 节点类型设置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NODE_TYPE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">slave</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 可选：前端基础URL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FRONTEND_BASE_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://your-domain.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 可选：同步频率</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SYNC_FREQUENCY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">60</span></span></code></pre></div>`,24)),a(e,{type:"info",title:"完整集群配置"},{default:s(()=>[...t[2]||(t[2]=[i(" 这只是基本的多节点配置示例。完整的集群部署配置、架构说明和最佳实践，请参考[集群部署指南](/zh/docs/installation/deployment-methods/cluster-deployment)。 ",-1)])]),_:1}),t[6]||(t[6]=d(`<h2 id="docker-compose中的环境变量示例" tabindex="-1">Docker Compose中的环境变量示例 <a class="header-anchor" href="#docker-compose中的环境变量示例" aria-label="Permalink to “Docker Compose中的环境变量示例”">​</a></h2><p>下面是一个在Docker Compose配置文件中设置环境变量的简要示例:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  new-api</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">calciumion/new-api:latest</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TZ=Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SQL_DSN=root:123456@tcp(mysql:3306)/oneapi</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">REDIS_CONN_STRING=redis://default:redispw@redis:6379</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SESSION_SECRET=your_unique_session_secret</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CRYPTO_SECRET=your_unique_crypto_secret</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MEMORY_CACHE_ENABLED=true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">GENERATE_DEFAULT_TOKEN=true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">STREAMING_TIMEOUT=120</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CHANNEL_UPDATE_FREQUENCY=1440</span></span></code></pre></div><p>有关完整的Docker Compose配置，包括更多环境变量设置选项，请参考<a href="/zh/docs/installation/config-maintenance/docker-compose-yml">Docker Compose配置说明</a>文档。</p><h2 id="linuxdo-相关" tabindex="-1">LinuxDo 相关 <a class="header-anchor" href="#linuxdo-相关" aria-label="Permalink to “LinuxDo 相关”">​</a></h2><p>正常情况下无需修改</p><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>LINUX_DO_TOKEN_ENDPOINT</code></td><td>LinuxDo 令牌端点</td><td><code>https://connect.linux.do/oauth2/token</code></td><td><code>LINUX_DO_TOKEN_ENDPOINT=https://connect.linux.do/oauth2/token</code></td></tr><tr><td><code>LINUX_DO_USER_ENDPOINT</code></td><td>LinuxDo 用户端点</td><td><code>https://connect.linux.do/api/user</code></td><td><code>LINUX_DO_USER_ENDPOINT=https://connect.linux.do/api/user</code></td></tr></tbody></table><h2 id="调试相关" tabindex="-1">调试相关 <a class="header-anchor" href="#调试相关" aria-label="Permalink to “调试相关”">​</a></h2><table tabindex="0"><thead><tr><th>环境变量</th><th>说明</th><th>默认值</th><th>示例</th></tr></thead><tbody><tr><td><code>ENABLE_PPROF</code></td><td>启用pprof性能分析</td><td><code>false</code></td><td><code>ENABLE_PPROF=true</code></td></tr><tr><td><code>DEBUG</code></td><td>启用调试模式</td><td><code>false</code></td><td><code>DEBUG=true</code></td></tr><tr><td><code>GIN_MODE</code></td><td>Gin运行模式</td><td>-</td><td><code>GIN_MODE=release</code></td></tr></tbody></table>`,9))])}const N=o(c,[["render",l]]);export{I as __pageData,N as default};
