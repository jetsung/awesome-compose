import{_ as a,o as i,c as t,aj as e}from"./chunks/framework.DpVzuYkC.js";const c=JSON.parse('{"title":"vaultwarden-backup","description":"","frontmatter":{},"headers":[],"relativePath":"vaultwarden-backup/index.md","filePath":"vaultwarden-backup/README.md"}'),d={name:"vaultwarden-backup/index.md"};function n(l,s,h,r,k,o){return i(),t("div",null,[...s[0]||(s[0]=[e(`<h1 id="vaultwarden-backup" tabindex="-1">vaultwarden-backup <a class="header-anchor" href="#vaultwarden-backup" aria-label="Permalink to “vaultwarden-backup”">​</a></h1><p><a href="https://github.com/ttionya/vaultwarden-backup" target="_blank" rel="noreferrer">Office Web</a> - <a href="https://github.com/ttionya/vaultwarden-backup" target="_blank" rel="noreferrer">Source</a> - <a href="https://hub.docker.com/r/ttionya/vaultwarden-backup" target="_blank" rel="noreferrer">Docker Image</a> - <a href="https://github.com/ttionya/vaultwarden-backup/blob/master/README_zh.md" target="_blank" rel="noreferrer">Document</a></p><hr><blockquote><p><a href="https://github.com/ttionya/vaultwarden-backup" target="_blank" rel="noreferrer">vaultwarden-backup</a> 是一个使用 rclone 备份 Vaultwarden 的开源项目</p></blockquote><hr><h2 id="配置-rclone-⚠️-必读-⚠️" tabindex="-1">配置 Rclone（⚠️ 必读 ⚠️） <a class="header-anchor" href="#配置-rclone-⚠️-必读-⚠️" aria-label="Permalink to “配置 Rclone（⚠️ 必读 ⚠️）”">​</a></h2><blockquote><p><strong>对于备份，你需要先配置 Rclone，否则备份工具不会工作。</strong><strong>对于还原，它不是必要的。</strong></p></blockquote><h3 id="配置远程存储" tabindex="-1">配置远程存储 <a class="header-anchor" href="#配置远程存储" aria-label="Permalink to “配置远程存储”">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--mount </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type=volume,source=vaultwarden-rclone-data,target=/config/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ttionya/vaultwarden-backup:latest </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rclone </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/data:/config/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ttionya/vaultwarden-backup:latest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rclone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span></span></code></pre></div><blockquote><p><strong>建议将远程名称设置为 <code>BitwardenBackup</code></strong>，否则需通过环境变量 <code>RCLONE_REMOTE_NAME</code> 指定。 OneDrive，先在本地使用 rclone config 设置后，再从 <code>~/.config/rclone/rclone.conf</code> 取数据复制到此服务的 <code>/config/rclone/rclone.conf</code>。</p></blockquote><h3 id="检查配置" tabindex="-1">检查配置 <a class="header-anchor" href="#检查配置" aria-label="Permalink to “检查配置”">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--mount </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type=volume,source=vaultwarden-rclone-data,target=/config/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ttionya/vaultwarden-backup:latest </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rclone </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> show</span></span></code></pre></div><hr><h2 id="备份" tabindex="-1">备份 <a class="header-anchor" href="#备份" aria-label="Permalink to “备份”">​</a></h2><h3 id="方法一-使用-docker-compose-推荐" tabindex="-1">方法一：使用 Docker Compose（推荐） <a class="header-anchor" href="#方法一-使用-docker-compose-推荐" aria-label="Permalink to “方法一：使用 Docker Compose（推荐）”">​</a></h3><ol><li>下载项目中的 <code>docker-compose.yml</code></li><li>根据实际情况编辑环境变量</li><li>在 <code>docker-compose.yml</code> 所在目录执行：</li></ol><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 停止</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重启</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 删除</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker-compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> down</span></span></code></pre></div><h3 id="方法二-自动备份-已有运行中的-vaultwarden" tabindex="-1">方法二：自动备份（已有运行中的 vaultwarden） <a class="header-anchor" href="#方法二-自动备份-已有运行中的-vaultwarden" aria-label="Permalink to “方法二：自动备份（已有运行中的 vaultwarden）”">​</a></h3><p>确保你的 vaultwarden 容器名为 <code>vaultwarden</code>，数据目录为 <code>/data</code>：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--restart=always </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--name </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">vaultwarden_backup</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--volumes-from=vaultwarden </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--mount </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type=volume,source=vaultwarden-rclone-data,target=/config/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DATA_DIR=&quot;/data&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ttionya/vaultwarden-backup:latest</span></span></code></pre></div><hr><h2 id="还原备份" tabindex="-1">还原备份 <a class="header-anchor" href="#还原备份" aria-label="Permalink to “还原备份”">​</a></h2><blockquote><p><strong>重要：还原会覆盖已有文件。操作前请停止 vaultwarden 容器，并将备份文件下载到本地。</strong></p></blockquote><h3 id="若使用项目-docker-compose-yml" tabindex="-1">若使用项目 <code>docker-compose.yml</code>： <a class="header-anchor" href="#若使用项目-docker-compose-yml" aria-label="Permalink to “若使用项目 docker-compose.yml：”">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--mount </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type=volume,source=vaultwarden-data,target=/bitwarden/data/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--mount </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type=bind,source=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,target=/bitwarden/restore/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ttionya/vaultwarden-backup:latest </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">restore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [OPTIONS]</span></span></code></pre></div><h3 id="若使用-自动备份-方式" tabindex="-1">若使用“自动备份”方式： <a class="header-anchor" href="#若使用-自动备份-方式" aria-label="Permalink to “若使用“自动备份”方式：”">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--mount </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type=volume,source=&quot;Docker卷名称&quot;,target=/data/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--mount </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type=bind,source=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,target=/bitwarden/restore/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DATA_DIR=&quot;/data&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ttionya/vaultwarden-backup:latest </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">restore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [OPTIONS]</span></span></code></pre></div><blockquote><p>或使用本地目录映射（将 <code>source</code> 改为本地绝对路径）：</p></blockquote><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--mount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> type=bind,source=&quot;/your/local/backup/dir&quot;,target=/data/</span></span></code></pre></div><h3 id="还原选项" tabindex="-1">还原选项 <a class="header-anchor" href="#还原选项" aria-label="Permalink to “还原选项”">​</a></h3><table tabindex="0"><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td><code>-f</code> / <code>--force-restore</code></td><td>强制还原（无交互确认）</td></tr><tr><td><code>--zip-file</code></td><td>指定压缩包（如 <code>backup.zip</code>）</td></tr><tr><td><code>-p</code> / <code>--password</code></td><td><strong>不安全！</strong> 直接指定压缩包密码（建议交互输入）</td></tr><tr><td><code>--db-file</code></td><td>指定数据库文件（如 <code>db.sqlite3</code>）</td></tr><tr><td><code>--config-file</code></td><td>指定 <code>config.json</code></td></tr><tr><td><code>--rsakey-file</code></td><td>指定 <code>rsakey.tar</code></td></tr><tr><td><code>--attachments-file</code></td><td>指定 <code>attachments.tar</code></td></tr><tr><td><code>--sends-file</code></td><td>指定 <code>sends.tar</code></td></tr></tbody></table><hr><h2 id="环境变量" tabindex="-1">环境变量 <a class="header-anchor" href="#环境变量" aria-label="Permalink to “环境变量”">​</a></h2><blockquote><p>所有变量均有默认值，可按需覆盖。</p></blockquote><h3 id="核心变量" tabindex="-1">核心变量 <a class="header-anchor" href="#核心变量" aria-label="Permalink to “核心变量”">​</a></h3><table tabindex="0"><thead><tr><th>变量</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td><code>RCLONE_REMOTE_NAME</code></td><td><code>BitwardenBackup</code></td><td>Rclone 远程名称</td></tr><tr><td><code>RCLONE_REMOTE_DIR</code></td><td><code>/BitwardenBackup/</code></td><td>远程备份目录</td></tr><tr><td><code>RCLONE_GLOBAL_FLAG</code></td><td><code>&#39;&#39;</code></td><td>Rclone 全局参数（勿用 <code>-P</code> 等影响输出的参数）</td></tr><tr><td><code>CRON</code></td><td><code>5 * * * *</code></td><td>备份计划（每小时 05 分）</td></tr><tr><td><code>ZIP_ENABLE</code></td><td><code>TRUE</code></td><td>是否打包为压缩文件</td></tr><tr><td><code>ZIP_PASSWORD</code></td><td><code>WHEREISMYPASSWORD?</code></td><td>压缩包密码（始终加密）</td></tr><tr><td><code>ZIP_TYPE</code></td><td><code>zip</code></td><td>压缩格式（<code>zip</code> 或 <code>7z</code>）</td></tr><tr><td><code>BACKUP_KEEP_DAYS</code></td><td><code>0</code></td><td>保留最近 N 天备份（<code>0</code> 表示永久保留）</td></tr><tr><td><code>BACKUP_FILE_SUFFIX</code></td><td><code>%Y%m%d</code></td><td>备份文件后缀（支持 <code>date</code> 格式，如 <code>%Y%m%d-%H%M</code>）</td></tr><tr><td><code>TIMEZONE</code></td><td><code>UTC</code></td><td>时区（如 <code>Asia/Shanghai</code>）</td></tr><tr><td><code>DISPLAY_NAME</code></td><td><code>vaultwarden</code></td><td>实例显示名称（仅用于日志/通知）</td></tr><tr><td><code>DATA_DIR</code></td><td><code>/bitwarden/data</code></td><td>vaultwarden 数据目录（自动备份时通常为 <code>/data</code>）</td></tr></tbody></table><h3 id="数据路径变量-一般无需修改" tabindex="-1">数据路径变量（一般无需修改） <a class="header-anchor" href="#数据路径变量-一般无需修改" aria-label="Permalink to “数据路径变量（一般无需修改）”">​</a></h3><table tabindex="0"><thead><tr><th>变量</th><th>默认值</th></tr></thead><tbody><tr><td><code>DATA_DB</code></td><td><code>\${DATA_DIR}/db.sqlite3</code></td></tr><tr><td><code>DATA_RSAKEY</code></td><td><code>\${DATA_DIR}/rsa_key</code></td></tr><tr><td><code>DATA_ATTACHMENTS</code></td><td><code>\${DATA_DIR}/attachments</code></td></tr><tr><td><code>DATA_SENDS</code></td><td><code>\${DATA_DIR}/sends</code></td></tr></tbody></table><blockquote><p>注：<code>DATA_DB</code> 也支持 PostgreSQL (<code>db.dump</code>) 和 MySQL (<code>db.sql</code>)。</p></blockquote><hr><h2 id="通知配置" tabindex="-1">通知配置 <a class="header-anchor" href="#通知配置" aria-label="Permalink to “通知配置”">​</a></h2><h3 id="ping-通知-推荐搭配-healthchecks-io" tabindex="-1">Ping 通知（推荐搭配 <a href="https://healthchecks.io/" target="_blank" rel="noreferrer">healthchecks.io</a>） <a class="header-anchor" href="#ping-通知-推荐搭配-healthchecks-io" aria-label="Permalink to “Ping 通知（推荐搭配 healthchecks.io）”">​</a></h3><table tabindex="0"><thead><tr><th>环境变量</th><th>触发时机</th></tr></thead><tbody><tr><td><code>PING_URL</code></td><td>完成（无论成功/失败）</td></tr><tr><td><code>PING_URL_WHEN_START</code></td><td>开始</td></tr><tr><td><code>PING_URL_WHEN_SUCCESS</code></td><td>成功</td></tr><tr><td><code>PING_URL_WHEN_FAILURE</code></td><td>失败</td></tr></tbody></table><blockquote><p>可搭配 <code>_CURL_OPTIONS</code> 后缀变量传入 <code>curl</code> 参数（如 <code>-H</code>, <code>-X</code> 等）。 支持占位符 <code>%{subject}</code> 和 <code>%{content}</code>。</p></blockquote><h4 id="测试-ping" tabindex="-1">测试 Ping <a class="header-anchor" href="#测试-ping" aria-label="Permalink to “测试 Ping”">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PING_URL_WHEN_SUCCESS=&#39;https://hc-ping.com/your-uuid&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ttionya/vaultwarden-backup:latest </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ping</span></span></code></pre></div><h3 id="邮件通知-基于-smtp" tabindex="-1">邮件通知（基于 SMTP） <a class="header-anchor" href="#邮件通知-基于-smtp" aria-label="Permalink to “邮件通知（基于 SMTP）”">​</a></h3><table tabindex="0"><thead><tr><th>变量</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td><code>MAIL_SMTP_ENABLE</code></td><td><code>FALSE</code></td><td>启用邮件</td></tr><tr><td><code>MAIL_SMTP_VARIABLES</code></td><td>—</td><td>SMTP 配置（<strong>勿用 <code>-s</code></strong>）</td></tr><tr><td><code>MAIL_TO</code></td><td>—</td><td>收件人邮箱</td></tr><tr><td><code>MAIL_WHEN_SUCCESS</code></td><td><code>TRUE</code></td><td>成功时发邮件</td></tr><tr><td><code>MAIL_WHEN_FAILURE</code></td><td><code>TRUE</code></td><td>失败时发邮件</td></tr><tr><td><code>MAIL_FORCE_THREAD</code></td><td><code>FALSE</code></td><td>强制邮件线程聚合</td></tr></tbody></table><h4 id="示例-mail-smtp-variables-zoho" tabindex="-1">示例 <code>MAIL_SMTP_VARIABLES</code>（Zoho）： <a class="header-anchor" href="#示例-mail-smtp-variables-zoho" aria-label="Permalink to “示例 MAIL_SMTP_VARIABLES（Zoho）：”">​</a></h4><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>-S smtp-use-starttls \\</span></span>
<span class="line"><span>-S smtp=smtp://smtp.zoho.com:587 \\</span></span>
<span class="line"><span>-S smtp-auth=login \\</span></span>
<span class="line"><span>-S smtp-auth-user=user@example.com \\</span></span>
<span class="line"><span>-S smtp-auth-password=yourpassword \\</span></span>
<span class="line"><span>-S from=user@example.com</span></span></code></pre></div><h4 id="测试邮件" tabindex="-1">测试邮件 <a class="header-anchor" href="#测试邮件" aria-label="Permalink to “测试邮件”">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MAIL_SMTP_VARIABLES=&#39;...&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MAIL_TO=&#39;you@example.com&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ttionya/vaultwarden-backup:latest </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mail</span></span></code></pre></div><hr><h2 id="环境变量加载方式" tabindex="-1">环境变量加载方式 <a class="header-anchor" href="#环境变量加载方式" aria-label="Permalink to “环境变量加载方式”">​</a></h2><h3 id="_1-使用-env-文件-推荐挂载" tabindex="-1">1. 使用 <code>.env</code> 文件（推荐挂载） <a class="header-anchor" href="#_1-使用-env-文件-推荐挂载" aria-label="Permalink to “1. 使用 .env 文件（推荐挂载）”">​</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--mount </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type=bind,source=/path/to/.env,target=/.env</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ttionya/vaultwarden-backup:latest</span></span></code></pre></div><blockquote><p><strong>不要用 <code>--env-file</code></strong>，会因引号处理错误导致配置失效。</p></blockquote><h3 id="_2-docker-secrets-敏感信息" tabindex="-1">2. Docker Secrets（敏感信息） <a class="header-anchor" href="#_2-docker-secrets-敏感信息" aria-label="Permalink to “2. Docker Secrets（敏感信息）”">​</a></h3><p>在变量名后加 <code>_FILE</code>，从文件读取值：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ZIP_PASSWORD_FILE=/run/secrets/zip-password</span></span></code></pre></div><h3 id="优先级顺序-高-→-低" tabindex="-1">优先级顺序（高 → 低）： <a class="header-anchor" href="#优先级顺序-高-→-低" aria-label="Permalink to “优先级顺序（高 → 低）：”">​</a></h3><ol><li>直接环境变量（如 <code>ZIP_PASSWORD</code>）</li><li><code>_FILE</code> 环境变量指向的文件内容</li><li><code>.env</code> 中的 <code>_FILE</code> 指向的文件</li><li><code>.env</code> 中的普通变量值</li></ol>`,62)])])}const g=a(d,[["render",n]]);export{c as __pageData,g as default};
