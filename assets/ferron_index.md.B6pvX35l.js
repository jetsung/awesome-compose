import{_ as i,o as a,c as n,aj as l}from"./chunks/framework.DpVzuYkC.js";const c=JSON.parse('{"title":"ferron","description":"","frontmatter":{},"headers":[],"relativePath":"ferron/index.md","filePath":"ferron/README.md"}'),t={name:"ferron/index.md"};function e(p,s,h,k,r,o){return a(),n("div",null,[...s[0]||(s[0]=[l(`<h1 id="ferron" tabindex="-1">ferron <a class="header-anchor" href="#ferron" aria-label="Permalink to “ferron”">​</a></h1><p><a href="https://ferron.sh/" target="_blank" rel="noreferrer">Office Web</a> - <a href="https://github.com/ferronweb/ferron" target="_blank" rel="noreferrer">Source</a> - <a href="https://hub.docker.com/r/ferronserver/ferron" target="_blank" rel="noreferrer">Docker Image</a> - <a href="https://ferron.sh/docs/installation/docker" target="_blank" rel="noreferrer">Document</a></p><hr><blockquote><p><a href="https://ferron.sh/" target="_blank" rel="noreferrer">ferron</a> 是针对速度、安全性和效率进行了优化的 Web 服务器。它用 Rust 编写，提供内存安全性和性能，使其成为现代网站的理想选择。</p></blockquote><hr><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to “配置”">​</a></h2><h3 id="官方原始的-ferron-kdl" tabindex="-1">官方原始的 <code>ferron.kdl</code> <a class="header-anchor" href="#官方原始的-ferron-kdl" aria-label="Permalink to “官方原始的 ferron.kdl”">​</a></h3><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// See https://ferron.sh/docs/configuration-kdl for the configuration reference</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Include all domain-specific configurations.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Each domain should have its own .kdl file in /etc/ferron.d/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// include &quot;/etc/ferron.d/**/*.kdl&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Global configuration.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Here you can put configuration that applies to all hosts,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// and even to the web server itself.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">globals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Log requests and errors into log files</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/log/ferron/access.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  error_log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/log/ferron/error.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Host configuration.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Here you can put configuration that applies to a specific host,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// by default a catch-all &quot;:80&quot; host that applies to all hostnames and port 80 (HTTP).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Replace &quot;:80&quot; with your domain name (pointing to your server) to use HTTPS.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// If you don&#39;t specify the paths to the TLS certificate and private key manually,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Ferron will obtain a TLS certificate automatically (via Let&#39;s Encrypt by default).</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">:80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Serve static files</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/www/ferron&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Reverse proxy to a backend server</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //proxy &quot;http://localhost:3000/&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Serve a PHP site with PHP-FPM (you would need to specify the webroot also used for serving static files)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Replace &quot;unix:///run/php/php-fpm.sock&quot; with your Unix socket URL</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //fcgi_php &quot;unix:///run/php/php-fpm.sock&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // If using Unix socket with PHP-FPM,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // set the listener owner and group in the PHP pool configuration to the web server user (\`ferron\`, if you used installer for GNU/Linux)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // For example:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //   listen.owner = ferron</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //   listen.group = ferron</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="基础的-ferron-kdl" tabindex="-1">基础的 <code>ferron.kdl</code> <a class="header-anchor" href="#基础的-ferron-kdl" aria-label="Permalink to “基础的 ferron.kdl”">​</a></h3><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// See https://ferron.sh/docs/configuration-kdl for the configuration reference</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Include all domain-specific configurations.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Each domain should have its own .kdl file in /etc/ferron.d/</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron.d/**/*.kdl&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Global configuration.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Here you can put configuration that applies to all hosts,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// and even to the web server itself.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">globals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Log requests and errors into log files</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/log/ferron/access.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  error_log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/log/ferron/error.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="扩展配置" tabindex="-1">扩展配置 <a class="header-anchor" href="#扩展配置" aria-label="Permalink to “扩展配置”">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/etc/ferron</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # tree</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ferron.kdl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http.d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http_default.kdl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https_default.kdl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default.crt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default.key</span></span></code></pre></div><ol><li>官方入口：<code>/etc/ferron.kdl</code></li></ol><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron/ferron.kdl&quot;</span></span></code></pre></div><ol start="2"><li>自定义入口：<code>/etc/ferron/ferron.kdl</code></li></ol><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron/http.d/*.kdl&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">globals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/log/ferron/access.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  error_log</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/log/ferron/error.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ol start="3"><li>80 端口和 443 端口示例：<code>/etc/ferron/http.d/example.com.kdl</code></li></ol><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Host configuration for example.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">example.com:443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls_contact</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;admin@example.com&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Replace with your email address</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls_challenge</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http-01&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls_letsencrypt_production</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 生产环境</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // auto_tls_letsencrypt_production #false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 测试环境</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls_cache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron/ssl/letsencrypt&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Specify cache directory for certificates</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Reverse proxy to a backend server</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  proxy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://localhost:8989&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// HTTP configuration for example.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">example.com:80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Redirect HTTP to HTTPS</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  status</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 301</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> location=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com{path_and_query}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>/etc/ferron/http.d/example.com.kdl</code></li></ul><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">snippet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;auto_tls&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls_contact</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;admin@example.com&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Replace with your email address</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls_challenge</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http-01&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls_letsencrypt_production</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 生产环境</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // auto_tls_letsencrypt_production #false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 测试环境</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls_cache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron/ssl/letsencrypt&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Specify cache directory for certificates</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Host configuration for example.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">example.com:443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Reverse proxy to a backend server</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  proxy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://localhost:8989&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;auto_tls&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// HTTP configuration for example.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">example.com:80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Redirect HTTP to HTTPS</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  status</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 301</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> location=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com{path_and_query}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ol start="4"><li>通用 80 端口入口（所有未配置的域名均走此）：<code>/etc/ferron/http.d/http_default.kdl</code></li></ol><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// /etc/ferron/http.d/http_default.kdl</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">*:80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // This configuration handles all unbound domain accesses on port 80</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // The * wildcard matches all hostnames not explicitly defined elsewhere</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Document root and index files</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/www/ferron&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;index.html&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;index.htm&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ol start="5"><li>通用 443 端口入口（所有未配置的域名均走此）：<code>/etc/ferron/http.d/https_default.kdl</code></li></ol><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// /etc/ferron/http.d/https_default.kdl</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">*:443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // This configuration handles all unbound domain accesses on port 443</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // The * wildcard matches all hostnames not explicitly defined elsewhere</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Document root and index files</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/var/www/ferron&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  index</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;index.html&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;index.htm&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Use self-signed certificates for default HTTPS access</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron/ssl/dummy.crt&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron/ssl/dummy.key&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Disable automatic TLS for the catch-all host</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auto_tls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> #false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>生成证书</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> req</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -x509</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nodes</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -days</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -newkey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rsa:2048</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -keyout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssl/dummy.key</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssl/dummy.crt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -subj</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/CN=&quot;</span></span></code></pre></div><ol start="6"><li>反向代理配置：<code>example.com.kdl</code></li></ol><div class="language-kdl"><button title="Copy Code" class="copy"></button><span class="lang">kdl</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// HTTP configuration for example.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">example.com:80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Redirect HTTP to HTTPS</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  status</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 301</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> location=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com{path_and_query}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// HTTPS configuration for example.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">example.com:443</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Use provided certificate files</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron/acmessl/example.com.fullchain.cer&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ferron/acmessl/example.com.key&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Reverse proxy to a backend server on port 9120</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  proxy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://host.docker.internal:8080&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Proxy settings</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  proxy_request_header</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;X-Forwarded-For&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;{client_ip}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  proxy_request_header</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;X-Forwarded-Proto&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;{scheme}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  proxy_request_header</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;X-Real-IP&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;{client_ip}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  proxy_request_header_replace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Host&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;{header:Host}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>`,28)])])}const g=i(t,[["render",e]]);export{c as __pageData,g as default};
